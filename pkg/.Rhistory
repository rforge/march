data <- read.table("dataAndre.txt")
data <- as.matrix(data)
datat <- matrix(0,23,42)
for(i in 1:23){
datat[i,]<-data[14*(i-1)+1,]
}
covariates <- array(0,c(23,42,13))
for(j in 1:13){
for(i in 1:23){
covariates[i,,j] <- data[14*(i-1)+(j+1),]
}
}
ptest <- march.dataset.loadFromDataFrame(datat,covariates=covariates)
setwd("~/march/pkg")
devtools::load_all()
setwd("~/")
data <- read.table("dataAndre.txt")
data <- as.matrix(data)
datat <- matrix(0,23,42)
for(i in 1:23){
datat[i,]<-data[14*(i-1)+1,]
}
covariates <- array(0,c(23,42,13))
for(j in 1:13){
for(i in 1:23){
covariates[i,,j] <- data[14*(i-1)+(j+1),]
}
}
ptest <- march.dataset.loadFromDataFrame(datat,covariates=covariates)
d5<-march.dcmm.construct(ptest,orderHC=2,orderVC=1,M=2,gen=2,popSize=4,iterBw=2,
Amodel="mtd",Cmodel="mtd",AMCovar=0,CMCovar=0)
march.dcmm.nbParams(d5)
d6<-march.dcmm.construct(ptest,orderHC=2,orderVC=1,M=2,gen=2,popSize=4,iterBw=2,
Amodel="mtdg",Cmodel="mtdg",AMCovar=0,CMCovar=0)
march.dcmm.nbParams(d6)
d5@Pi
d4<-march.dcmm.construct(ptest,orderHC=2,orderVC=1,M=2,gen=2,popSize=4,iterBw=2,
Amodel="mtdg",Cmodel="mtdg",AMCovar=c(1,0,0,0,0,0,1,0,0,0,0,0,0),CMCovar=c(1,0,0,0,0,0,1,0,0,0,0,0,0))
d5<-march.dcmm.construct(ptest,orderHC=2,orderVC=1,M=2,gen=2,popSize=4,iterBw=2,
Amodel="mtdg",Cmodel="mtdg",AMCovar=0,CMCovar=0)
march.dcmm.nbParams(d5)
d5@Pi
d5<-march.dcmm.construct(ptest,orderHC=2,orderVC=1,M=2,gen=2,popSize=4,iterBw=2,
Amodel="mtdg",Cmodel="mtdg",AMCovar=0,CMCovar=0)
march.dcmm.nbParams(d5)
d5@Pi
d5<-march.dcmm.construct(ptest,orderHC=2,orderVC=1,M=2,gen=2,popSize=4,iterBw=2,
Amodel="complete",Cmodel="complete",AMCovar=0,CMCovar=0)
march.dcmm.nbParams(d5)
d5@Pi
d5<-march.dcmm.construct(ptest,orderHC=2,orderVC=1,M=2,gen=2,popSize=4,iterBw=2,
Amodel="complete",Cmodel="complete",AMCovar=0,CMCovar=0)
march.dcmm.nbParams(d5)
d5@Pi
d5<-march.dcmm.construct(ptest,orderHC=2,orderVC=1,M=2,gen=2,popSize=4,iterBw=2,
Amodel="mtd",Cmodel="mtd",AMCovar=0,CMCovar=0)
setwd("/march/pkg")
setwd("~/march/pkg")
devtools::load_all()
d5<-march.dcmm.construct(ptest,orderHC=2,orderVC=1,M=2,gen=2,popSize=4,iterBw=2,
Amodel="mtd",Cmodel="mtd",AMCovar=0,CMCovar=0)
march.dcmm.nbParams(d5)
d5@Pi
ip <- new("march.dcmm.cov.ea.InitParameters",AConst=FALSE,y=ptest,orderVC=1,orderHC=2,M=2,Amodel="mtd",Cmodel="mtd",AMCovar=0,CMCovar=0,fct=march.dcmm.cov.ea.initialization)
ip <- new("march.dcmm.cov.ea.InitParameters",AConst=FALSE,y=ptest,orderVC=as.integer(1),orderHC=as.integer(2),M=as.integer(2),Amodel="mtd",Cmodel="mtd",AMCovar=0,CMCovar=0,fct=march.dcmm.cov.ea.initialization)
dd1<-march.dcmm.cov.ea.initialization(ip)
dd1@Pi
mp <- new("march.dcmm.cov.ea.MutationParameters",pMut=as.numeric(0.05),fct=march.dcmm.cov.ea.mutation)
mp <- new("march.dcmm.cov.ea.MutationParameters",pMut=as.numeric(0.05),fct=march.dcmm.cov.ea.mutation)
dd2<-march.dcmm.cov.ea.mutation(dd1,mp)
dd2@Pi
ip <- new("march.dcmm.cov.ea.InitParameters",AConst=FALSE,y=ptest,orderVC=as.integer(1),orderHC=as.integer(2),M=as.integer(2),Amodel="mtd",Cmodel="mtd",AMCovar=0,CMCovar=0,fct=march.dcmm.cov.ea.initialization)
dd1<-march.dcmm.cov.ea.initialization(ip)
dd2<-march.dcmm.cov.ea.initialization(ip)
mp <- new("march.dcmm.cov.ea.MutationParameters",pMut=as.numeric(0.05),fct=march.dcmm.cov.ea.mutation)
dd2<-march.dcmm.cov.ea.mutation(dd1,mp)
cp <- new("march.ea.cov.CrossoverParameters",fct=march.dcmm.cov.ea.crossover)
dd3<-march.dcmm.cov.ea.crossover(dd1,dd2)
ip <- new("march.dcmm.cov.ea.InitParameters",AConst=FALSE,y=ptest,orderVC=as.integer(1),orderHC=as.integer(2),M=as.integer(2),Amodel="mtd",Cmodel="mtd",AMCovar=0,CMCovar=0,fct=march.dcmm.cov.ea.initialization)
dd1<-march.dcmm.cov.ea.initialization(ip)
dd2<-march.dcmm.cov.ea.initialization(ip)
mp <- new("march.dcmm.cov.ea.MutationParameters",pMut=as.numeric(0.05),fct=march.dcmm.cov.ea.mutation)
dd3<-march.dcmm.cov.ea.mutation(dd1,mp)
cp <- new("march.ea.cov.CrossoverParameters",fct=march.dcmm.cov.ea.crossover)
dd4<-march.dcmm.cov.ea.crossover(dd1,dd2)
dd4@Pi
dd2@Pi
dd1@Pi
dd3@Pi
dd4@Pi
dd4
dd4$c1@Pi
dd1@Pi
dd2@Pi
dd4$c1@orderHC
dd1@M^(i-1)*1
i
i=1
d1@M^(i-1)*AtmCovar
dd1@M^(i-1)*AtmCovar
dd1@M^(i-1)*1
ip <- new("march.dcmm.cov.ea.InitParameters",AConst=FALSE,y=ptest,orderVC=as.integer(1),orderHC=as.integer(2),M=as.integer(2),Amodel="mtdg",Cmodel="mtdg",AMCovar=0,CMCovar=0,fct=march.dcmm.cov.ea.initialization)
dd1<-march.dcmm.cov.ea.initialization(ip)
dd2<-march.dcmm.cov.ea.initialization(ip)
mp <- new("march.dcmm.cov.ea.MutationParameters",pMut=as.numeric(0.05),fct=march.dcmm.cov.ea.mutation)
dd3<-march.dcmm.cov.ea.mutation(dd1,mp)
cp <- new("march.ea.cov.CrossoverParameters",fct=march.dcmm.cov.ea.crossover)
dd4<-march.dcmm.cov.ea.crossover(dd1,dd2)
dd4$c1@Pi
dd1@Pi
dd2@Pi
dd3@Pi
d1<-dd1
d2<-dd2
NbAMCovar <- sum(d1@AMCovar)
NbCMCovar <- sum(d1@CMCovar)
placeACovar <- which(d1@AMCovar==1)
placeCCovar <- which(d1@CMCovar==1)
AtmCovar <- 1
if(NbAMCovar>0){
for (i in 1:NbAMCovar){
AtmCovar <- AtmCovar*d1@y@Kcov[placeACovar[i]]
}
}
c1 <- march.dcmm.cov.constructEmptyDcmm(d1@M,d1@y,d1@orderVC,d1@orderHC,d1@AMCovar,d1@CMCovar,d1@Amodel,d1@Cmodel)
c2 <- march.dcmm.cov.constructEmptyDcmm(d1@M,d1@y,d1@orderVC,d1@orderHC,d1@AMCovar,d1@CMCovar,d1@Amodel,d1@Cmodel)
c1@Pi
devtools::load_all()
d5<-march.dcmm.construct(ptest,orderHC=2,orderVC=1,M=2,gen=2,popSize=4,iterBw=2,
Amodel="mtd",Cmodel="mtd",AMCovar=0,CMCovar=0)
march.dcmm.nbParams(d5)
d5@Pi
ip <- new("march.dcmm.cov.ea.InitParameters",AConst=FALSE,y=ptest,orderVC=as.integer(1),orderHC=as.integer(2),M=as.integer(2),Amodel="mtdg",Cmodel="mtdg",AMCovar=0,CMCovar=0,fct=march.dcmm.cov.ea.initialization)
dd1<-march.dcmm.cov.ea.initialization(ip)
dd2<-march.dcmm.cov.ea.initialization(ip)
mp <- new("march.dcmm.cov.ea.MutationParameters",pMut=as.numeric(0.05),fct=march.dcmm.cov.ea.mutation)
dd3<-march.dcmm.cov.ea.mutation(dd1,mp)
cp <- new("march.ea.cov.CrossoverParameters",fct=march.dcmm.cov.ea.crossover)
dd4<-march.dcmm.cov.ea.crossover(dd1,dd2)
dd4$c1@Pi
dd4$c2@Pi
d6<-march.dcmm.construct(ptest,orderHC=2,orderVC=1,M=2,gen=2,popSize=4,iterBw=2,
Amodel="mtdg",Cmodel="mtdg",AMCovar=0,CMCovar=0)
march.dcmm.nbParams(d6)
d6@APhi
d6@CQ
d6@CPhi
d6@CQ
d6@AQ
d6@Pi
march.summary(d1)
march.show(d1)
march.dcmm.show(d1)
?march.dcmm.construct
march.dcmm.construct(y=pewee,orderHC=2,orderVC=1,M=2,popSize=2,gen=1,iterBw=1,stopBw=0.0001)
# Same as above, but the DCMM is replaced by a HMM (the visible order OrderVC is set to zero).
HMM<-march.dcmm.construct(y=pewee,orderHC=2,orderVC=0,M=2,popSize=2,gen=1,iterBw=1,stopBw=0.0001)
# A first model is computed using both EA and Baum-Welch algorithms.
# The previous model is improved through two rounds of Baum-Welch optimization.
models <- list()
models[[length(models)+1]] <- HMM
models[[length(models)+1]] <- march.dcmm.construct(y=pewee,seedModel=models[[1]],orderVC=0,iterBw=10,stopBw=0.001)
models[[length(models)+1]] <- march.dcmm.construct(y=pewee,seedModel=models[[2]],orderVC=0,iterBw=10,stopBw=0.0001)
r <- do.call(rbind,lapply(models,march.summary))
march.nbParams(models[[1]])
models[[1]]
models[[1]]@RB
models[[1]]@RB[,,1]
# The previous model is improved through two rounds of Baum-Welch optimization.
models <- list()
#models[[length(models)+1]] <- HMM
models[[length(models)+1]] <- march.dcmm.construct(y=pewee,seedModel=models[[1]],orderVC=0,iterBw=10,stopBw=0.001)
models[[length(models)+1]] <- march.dcmm.construct(y=pewee,seedModel=models[[2]],orderVC=0,iterBw=10,stopBw=0.0001)
# Show performance indicators (ll, number of independent parameters,
models <- list()
models[[length(models)+1]] <- march.dcmm.construct(y=pewee,seedModel=models[[1]],orderVC=0,iterBw=10,stopBw=0.001)
models <- list()
models[[length(models)+1]] <- HMM
models[[length(models)+1]] <- march.dcmm.construct(y=pewee,seedModel=models[[1]],orderVC=0,iterBw=10,stopBw=0.001)
models <- list()
models[[length(models)+1]] <- HMM
models[[length(models)+1]] <- march.dcmm.construct(y=pewee,seedModel=models[[1]],orderVC=0,iterBw=10,stopBw=0.001)
models[[length(models)+1]] <- march.dcmm.construct(y=pewee,seedModel=models[[2]],orderVC=0,iterBw=10,stopBw=0.0001)
# Show performance indicators (ll, number of independent parameters,
# BIC and AIC) for all computed models.
r <- do.call(rbind,lapply(models,march.summary))
MatTest<-matrix(0,1,3)
sum(MatTest==0)
sum(sum(MatTest==0))
sum(sum(MatTest)==0)
devtools::load_all()
r <- do.call(rbind,lapply(models,march.summary))
r
march.dcmm.show(HMM)
devtools::load_all()
march.dcmm.show(HMM)
march.dcmm.show(models[[2]])
march.dcmm.show(d1)
march.dcmm.show(d2)
d5<-march.dcmm.construct(ptest,orderHC=1,orderVC=2,M=2,gen=2,popSize=4,iterBw=2,
Amodel="mtd",Cmodel="mtd",AMCovar=0,CMCovar=0)
march.dcmm.show(d5)
d5@RB
devtools::load_all()
devtools::load_all()
march.dcmm.show(HMM)
devtools::load_all()
march.dcmm.show(HMM)
HMM@RB
matrix(HMM@RB[,,i],1,object@y@K)
matrix(HMM@RB[,,i],1,HMM@y@K)
devtools::load_all()
march.dcmm.show(HMM)
devtools::load_all()
march.dcmm.show(HMM)
s<-t(data.frame(object@RB[,,1]))
s<-t(data.frame(HMM@RB[,,1]))
order<-1
K<-3
tCovar<-1
colnames(s) <- 1:K
rn <- rep("",dim(s)[1])
values <- 1:K
for(i in march.h.seq(1,order)){
tmp <- as.character(kronecker(values,rep(1,K^order*tCovar/K^i)))
rn <- paste(tmp,rn)
}
rn <- paste(rep("",dim(s)[1]),rn)
rn
paste("",1,:)
paste("",1,":")
ncov<-3
kcov<-c(2,3,4)
tCovar <- 1
if(prod(kcov)>0){
tCovar <- prod(kcov)
}
colnames(s) <- 1:K
rn <- rep("",dim(s)[1])
if(ncov==0){
rownames(s)<-paste(rn,1,:)
}else{
totm <- tCovar
for(i in 1:ncov){
totm <-totm/kcov[i]
values <- 1:kcov[i]
tmp <- as.character(kronecker(values,rep(1,totm)))
rn <- paste(rn,tmp)
}
}
tCovar <- 1
if(prod(kcov)>0){
tCovar <- prod(kcov)
}
colnames(s) <- 1:K
rn <- rep("",dim(s)[1])
if(ncov==0){
rownames(s)<-paste(rn,1,":")
}else{
totm <- tCovar
for(i in 1:ncov){
totm <-totm/kcov[i]
values <- 1:kcov[i]
tmp <- as.character(kronecker(values,rep(1,totm)))
rn <- paste(rn,tmp)
}
}
rn
devtools::load_all()
devtools::load_all()
march.show(HMM)
march.dcmm.show(HMM)
devtools::load_all()
march.dcmm.show(HMM)
s<-t(data.frame(object@RB[,,1]))
s<-t(data.frame(HMM@RB[,,1]))
s
K<-3
ncov<-o
ncov<-0
kcov<-0
tCovar <- 1
if(prod(kcov)>0){
tCovar <- prod(kcov)
}
colnames(s) <- 1:K
rn <- rep("",dim(s)[1])
if(ncov==0){
rownames(s)<-paste(rn,1,":")
}else{
totm <- tCovar
for(i in 1:ncov){
totm <-totm/kcov[i]
values <- 1:kcov[i]
tmp <- as.character(kronecker(values,rep(1,totm)))
rn <- paste(rn,tmp)
}
rownames(s) <- paste(rn,":")
}
s
s
s <- march.cov.h.mc.printableMatrix.orderVC0(t(data.frame(HMM@RB[,,i])),object@y@K,HMM@y@Kcov[placeCCovar],sum(HMM@CMCovar))
s <- march.cov.h.mc.printableMatrix.orderVC0(t(data.frame(HMM@RB[,,i])),HMM@y@K,HMM@y@Kcov[placeCCovar],sum(HMM@CMCovar))
s <- march.cov.h.mc.printableMatrix.orderVC0(t(data.frame(HMM@RB[,,1])),HMM@y@K,HMM@y@Kcov[placeCCovar],sum(HMM@CMCovar))
print(s)
object<-HMM
cat("RB : \n")
for( i in 1:object@M ){
cat(i,":\n");
if(object@orderVC==0){
s <- march.cov.h.mc.printableMatrix.orderVC0(t(data.frame(object@RB[,,i])),object@y@K,object@y@Kcov[placeCCovar],sum(object@CMCovar))
}else{
s <- march.cov.h.mc.printableMatrix(object@RB[,,i],object@orderVC,object@y@K,object@y@Kcov[placeCCovar],sum(object@CMCovar))
print(s)
}
}
devtools::load_all()
march.dcmm.show(HMM)
devtools::load_all()
march.dcmm.show(HMM)
d4<-march.dcmm.construct(ptest,orderHC=2,orderVC=0,M=2,gen=2,popSize=4,iterBw=2,
Amodel="mtdg",Cmodel="mtdg",AMCovar=c(1,0,0,0,0,0,1,0,0,0,0,0,0),CMCovar=c(1,0,0,0,0,0,1,0,0,0,0,0,0))
d4
object<-d4
s <- march.cov.h.mc.printableMatrix.orderVC0(t(data.frame(object@RB[,,i])),object@y@K,object@y@Kcov[placeCCovar],sum(object@CMCovar))
s<-t(data.frame(object@RB[,,1]))
K<-2
kcov<-c(4,5)
ncov<-2
tCovar <- 1
if(prod(kcov)>0){
tCovar <- prod(kcov)
}
colnames(s) <- 1:K
s
s <- march.cov.h.mc.printableMatrix.orderVC0(matrix(object@RB[,,i]),AtmCovar,object@y@K),object@y@K,object@y@Kcov[placeCCovar],sum(object@CMCovar))
s <- march.cov.h.mc.printableMatrix.orderVC0(matrix(object@RB[,,i],AtmCovar,object@y@K),object@y@K,object@y@Kcov[placeCCovar],sum(object@CMCovar))
i<-1
s <- march.cov.h.mc.printableMatrix.orderVC0(matrix(object@RB[,,i],AtmCovar,object@y@K),object@y@K,object@y@Kcov[placeCCovar],sum(object@CMCovar))
placeACovar <- which(object@AMCovar==1)
placeCCovar <- which(object@CMCovar==1)
AtmCovar <- 1
if(sum(object@AMCovar>0)){
AtmCovar <-prod(object@y@Kcov[placeACovar])
}
s <- march.cov.h.mc.printableMatrix.orderVC0(matrix(object@RB[,,i],AtmCovar,object@y@K),object@y@K,object@y@Kcov[placeCCovar],sum(object@CMCovar))
print(s)
devtools::load_all()
d4
print(HMM)
d5<-march.dcmm.construct(ptest,orderHC=0,orderVC=2,M=2,gen=2,popSize=4,iterBw=2,
Amodel="mtd",Cmodel="mtd",AMCovar=0,CMCovar=0)
march.dcmm.nbParams(d5)
d1<-march.dcmm.construct(ptest,orderHC=2,orderVC=1,M=3,gen=1,popSize=3,iterBw=2,
Amodel="complete",Cmodel="complete",AMCovar=c(1,0,0,0,0,0,1,0,0,0,0,0,0),CMCovar=c(1,0,0,0,0,0,1,0,0,0,0,0,0))
devtools::load_all()
d1<-march.dcmm.construct(ptest,orderHC=2,orderVC=1,M=3,gen=1,popSize=3,iterBw=2,
Amodel="complete",Cmodel="complete",AMCovar=c(1,0,0,0,0,0,1,0,0,0,0,0,0),CMCovar=c(1,0,0,0,0,0,1,0,0,0,0,0,0))
d5<-march.dcmm.construct(ptest,orderHC=2,orderVC=2,M=2,gen=2,popSize=4,iterBw=2,
Amodel="mtd",Cmodel="mtd",AMCovar=0,CMCovar=0)
march.dcmm.nbParams(d5)
d5<-march.dcmm.construct(ptest,orderHC=2,orderVC=2,M=2,gen=2,popSize=4,iterBw=2,
Amodel="mtd",Cmodel="mtd",AMCovar=0,CMCovar=0,pMut=0.02,pCross=0.5)
march.dcmm.nbParams(d5)
document()
devtools::document()
devtools::document()
march.ci.h.d2n(0.01)
march.dcmm.test
?march.dcmm.test
devtools:document()
devtools::document()
d1<-march.dcmm.construct(ptest,orderHC=2,orderVC=1,M=3,gen=1,popSize=3,iterBw=2,
Amodel="complete",Cmodel="complete",AMCovar=c(1,0,0,0,0,0,1,0,0,0,0,0,0),CMCovar=c(1,0,0,0,0,0,1,0,0,0,0,0,0))
march.dcmm.nbParams(d1)
devtools:document()
devtools:;document()
devtools::document()
